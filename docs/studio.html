<!doctype html><html lang="fr"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Studio</title><link rel="preconnect" href="https://cdn.jsdelivr.net"><style>:root{--bg:#0b0f17;--panel:#0f1522;--elev:#111827;--line:#1f2937;--text:#e5e7eb;--muted:#a3a3a3;--accent:#7c3aed;--accent-2:#22d3ee;--btn:#1f2937;--btn-hover:#374151;--chip:#0b1324}*{box-sizing:border-box}html,body{height:100%}body{margin:0;background:linear-gradient(180deg,#0a0e16 0%,#0b0f17 60%,#0c111c 100%);color:var(--text);font:14px/1.6 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial}header{position:sticky;top:0;z-index:10;display:grid;grid-template-columns:auto 1fr auto auto auto auto auto auto auto auto;gap:8px;align-items:center;padding:10px 12px;background:rgba(15,21,34,0.9);backdrop-filter:saturate(140%) blur(8px);border-bottom:1px solid var(--line);box-shadow:0 10px 30px rgba(0,0,0,0.35)}header .logo{display:flex;align-items:center;gap:10px;padding:6px 10px;border-radius:12px;background:linear-gradient(135deg,#0e1628,#0b1324);border:1px solid #10182a;box-shadow:inset 0 1px 0 rgba(255,255,255,0.03)}header .logo b{letter-spacing:.4px}header .dot{width:8px;height:8px;border-radius:999px;background:radial-gradient(circle at 30% 30%,#8b5cf6,transparent 60%),radial-gradient(circle at 70% 70%,#22d3ee,transparent 60%);box-shadow:0 0 16px #7c3aed,0 0 8px #22d3ee}header button,header input,header output{height:36px}header button{appearance:none;border:1px solid var(--line);background:linear-gradient(180deg,#182033,#12192b);color:var(--text);padding:0 12px;border-radius:10px;cursor:pointer;transition:transform .05s ease,background .2s ease,border-color .2s ease;box-shadow:0 2px 0 rgba(0,0,0,.45),0 6px 16px rgba(0,0,0,.25)}header button:hover{background:linear-gradient(180deg,#1c2740,#142035);border-color:#2b3a55}header button:active{transform:translateY(1px)}header button.primary{background:linear-gradient(180deg,#6d28d9,#5b21b6);border-color:#7c3aed}header button.primary:hover{background:linear-gradient(180deg,#7c3aed,#6d28d9)}header input#prompt{width:100%;min-width:240px;padding:0 12px;border:1px solid var(--line);border-radius:10px;background:#0b1324;color:var(--text);outline:none;box-shadow:inset 0 1px 0 rgba(255,255,255,.02)}header input#prompt::placeholder{color:var(--muted)}header output#status{min-width:160px;display:flex;align-items:center;justify-content:flex-end;color:#c4b5fd}main{height:calc(100% - 58px);display:grid;grid-template-columns:280px 1fr 1fr}#files{border-right:1px solid var(--line);background:linear-gradient(180deg,#0c1323,#0a1020);overflow:auto}#files .bar{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;border-bottom:1px solid var(--line);color:var(--muted);font-size:12px;letter-spacing:.3px;text-transform:uppercase}#files ul{list-style:none;margin:0;padding:8px}#files li{padding:8px 10px;border-radius:10px;cursor:pointer;display:flex;justify-content:space-between;gap:8px;color:#d1d5db;border:1px solid transparent}#files li:hover{background:#0e1530;border-color:#1b2442}#files li.active{background:linear-gradient(180deg,#121a35,#0e1530);border-color:#26314e;box-shadow:inset 0 1px 0 rgba(255,255,255,.03)}#files .name{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}#editor{border-right:1px solid var(--line);background:linear-gradient(180deg,#0b1324,#0a1020)}textarea{width:100%;height:100%;border:0;outline:0;padding:14px 16px;resize:none;background:transparent;color:#e5e7eb;font-family:ui-monospace,Consolas,Menlo,monospace;font-size:13.5px;line-height:1.55}textarea:focus{box-shadow:inset 0 0 0 1px rgba(124,58,237,.35)}iframe{width:100%;height:100%;border:0;background:#0b1324;border-left:1px solid var(--line)}::-webkit-scrollbar{width:10px;height:10px}::-webkit-scrollbar-thumb{background:#22314d;border-radius:10px;border:2px solid #0b0f17}::-webkit-scrollbar-track{background:transparent}.chip{display:inline-flex;align-items:center;gap:8px;padding:4px 8px;border-radius:999px;background:#0b1324;border:1px solid #13203b;color:#9ca3af;font-size:12px}.kbd{padding:2px 6px;border-radius:6px;background:#121a2e;border:1px solid #203053;color:#cbd5e1;font-family:ui-monospace,Consolas,monospace;font-size:12px}</style><script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script></head><body>
<header>
  <div class="logo"><span class="dot"></span><b>Studio</b></div>
  <input id="prompt" placeholder="Décris ce que tu veux générer">
  <button id="ai-propose" class="primary">IA Proposer</button>
  <button id="ai-analyze">IA Analyser</button>
  <button id="new">Nouveau</button>
  <button id="rename">Renommer</button>
  <button id="delete">Supprimer</button>
  <button id="save">Enregistrer</button>
  <button id="download">ZIP</button>
  <button id="import">Importer</button><input id="zip" type="file" accept=".zip" style="display:none">
  <button id="preview">Aperçu</button>
  <button id="reset">Reset</button>
  <output id="status"></output>
</header>
<main>
  <aside id="files"><div class="bar"><span>Fichiers</span><span class="chip">Local</span></div><ul id="list"></ul></aside>
  <section id="editor"><textarea id="code"></textarea></section>
  <section><iframe id="frame" sandbox="allow-scripts"></iframe></section>
</main>
<script src="ai.js"></script>
<script>
const KEY="studio.fs.v1";
const list=document.getElementById("list");
const code=document.getElementById("code");
const frame=document.getElementById("frame");
const promptInput=document.getElementById("prompt");
const statusOut=document.getElementById("status");
let fs=loadFS();
let current=null;
let history={};let cursor={};
let typingTimer=null;
let lock=false;

function setStatus(t){statusOut.textContent=t}
function setLock(v){lock=v;for(const id of ["ai-propose","ai-analyze","new","rename","delete","save","download","import","preview","reset"]){const el=document.getElementById(id);if(!el)continue;el.disabled=v;el.style.opacity=v?.6:1}promptInput.disabled=v}

function loadFS(){const raw=localStorage.getItem(KEY);if(raw){try{return JSON.parse(raw)}catch(e){}}return {"index.html":"<!doctype html><html><head><meta charset='utf-8'><title>Exemple</title><style>body{font:16px/1.5 system-ui;margin:24px}</style></head><body><h1>Bonjour</h1><p>Modifie ce fichier puis clique Aperçu.</p></body></html>"}}
function saveFS(){localStorage.setItem(KEY,JSON.stringify(fs))}
function renderList(){list.innerHTML="";Object.keys(fs).sort().forEach(name=>{const li=document.createElement("li");li.dataset.name=name;li.className=name===current?"active":"";const span=document.createElement("span");span.className="name";span.textContent=name;const size=document.createElement("span");size.textContent=(new Blob([fs[name]]).size)+"o";li.appendChild(span);li.appendChild(size);li.onclick=()=>openFile(name);list.appendChild(li)})}
function openFile(name){if(!fs[name])return;commitState();current=name;code.value=fs[name];renderList();resetHistoryIfNeeded(name)}
function resetHistoryIfNeeded(name){if(!history[name]){history[name]=[fs[name]];cursor[name]=0}else{cursor[name]=history[name].length-1}}
function commitState(){if(!current)return;const arr=history[current]||[fs[current]];const idx=cursor[current]??(arr.length-1);const latest=arr[idx];if(code.value!==latest){const next=arr.slice(0,idx+1);next.push(code.value);history[current]=next;cursor[current]=next.length-1;fs[current]=code.value;saveFS()}}
function preview(){commitState();const blob=new Blob([fs[current]||""],{type:"text/html"});frame.src=URL.createObjectURL(blob)}
function ensureSelection(){if(!current){const first=Object.keys(fs)[0];openFile(first)}}

document.getElementById("new").onclick=()=>{if(lock)return;let name=prompt("Nom du fichier","nouveau.html");if(!name)return;if(fs[name]){alert("Existe déjà");return}fs[name]="";saveFS();renderList();openFile(name)};
document.getElementById("rename").onclick=()=>{if(lock)return;ensureSelection();if(!current)return;const nv=prompt("Nouveau nom",current);if(!nv||nv===current)return;if(fs[nv]){alert("Existe déjà");return}fs[nv]=fs[current];delete fs[current];history[nv]=history[current];cursor[nv]=cursor[current];delete history[current];delete cursor[current];saveFS();renderList();openFile(nv)};
document.getElementById("delete").onclick=()=>{if(lock)return;ensureSelection();if(!current)return;if(!confirm("Supprimer "+current+" ?"))return;delete fs[current];delete history[current];delete cursor[current];saveFS();current=null;renderList();ensureSelection();preview()};
document.getElementById("save").onclick=()=>{if(lock)return;commitState();setStatus("Enregistré");preview();setTimeout(()=>setStatus(""),1000)};
document.getElementById("download").onclick=async()=>{if(lock)return;const zip=new JSZip();for(const [name,content] of Object.entries(fs)){zip.file(name,content)}const blob=await zip.generateAsync({type:"blob"});const a=document.createElement("a");a.href=URL.createObjectURL(blob);a.download="projet.zip";a.click();URL.revokeObjectURL(a.href)};
document.getElementById("import").onclick=()=>{if(lock)return;document.getElementById("zip").click()};
document.getElementById("zip").onchange=async e=>{if(lock)return;const f=e.target.files[0];if(!f)return;const zip=await JSZip.loadAsync(f);let imported=0;for(const path of Object.keys(zip.files)){const file=zip.files[path];if(file.dir)continue;const content=await file.async("string");fs[path]=content;imported++}if(imported===0){alert("ZIP vide");return}saveFS();renderList();openFile(Object.keys(fs)[0]);preview()};
document.getElementById("preview").onclick=()=>{if(lock)return;preview()};
document.getElementById("reset").onclick=()=>{if(lock)return;if(!confirm("Réinitialiser le studio ?"))return;localStorage.removeItem(KEY);location.reload()};

code.addEventListener("input",()=>{clearTimeout(typingTimer);typingTimer=setTimeout(()=>{commitState();preview()},350)});

document.getElementById("ai-propose").onclick=async()=>{if(lock)return;setLock(true);setStatus("IA en cours");try{const res=await window.ai.generate(promptInput.value||"");if(res&&res.files){fs=window.ai.loadFS();renderList();const names=Object.keys(res.files);const target=names.includes("index.html")?"index.html":names[0];if(target)openFile(target);preview()}setStatus(res.summary?res.summary:"IA terminé");setTimeout(()=>setStatus(""),1500)}catch(e){setStatus("Erreur IA")}finally{setLock(false)}};
document.getElementById("ai-analyze").onclick=async()=>{if(lock)return;setLock(true);setStatus("Analyse en cours");try{const res=await window.ai.analyze();const html=["<!doctype html><meta charset='utf-8'><title>Analyse</title><style>body{font:14px system-ui;margin:20px;line-height:1.6;color:#e5e7eb;background:#0b1324}h1{margin:0 0 8px}h2{margin:16px 0 8px}ul{padding-left:18px}</style><h1>Analyse</h1>",section("Problèmes",res.issues),section("Actions",res.actions),section("Avertissements",res.warnings)].join("");frame.srcdoc=html;setStatus("Analyse affichée");setTimeout(()=>setStatus(""),1500)}catch(e){setStatus("Erreur analyse")}finally{setLock(false)}};
function section(title,items){const arr=Array.isArray(items)?items:[];return "<h2>"+title+"</h2><ul>"+arr.map(x=>"<li>"+String(x)+"</li>").join("")+"</ul>"}

renderList();ensureSelection();preview();
</script>
</body></html>
